# The following script checks if a Citrix ADC is vulberable to unauth remote code execution by comparing the MD5 hash of the VPN/index.html file
# A reverse shell exploit code will be available soon on this repo.


# -*- coding: utf-8 -*-

import requests
import json
import sys
import getpass
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def main():
    target = sys.argv[1]
    url = "https://" + target + "/vpn/index.html"
    try:
        r = requests.get(url, verify=False)
        if "c1b64cea1b80e973580a73b787828daf" in r.text:
            print("Citrix version 12.1-65.21 is vulnerable to RCE")
            sys.exit(0)
        else:
            print("Citrix is not vulnerable to RCE")
            sys.exit(1)
    except requests.exceptions.RequestException as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.HTTPError as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.ConnectionError as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.Timeout as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.TooManyRedirects as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.SSLError as e:
        print(e)
        sys.exit(1)
    except requests.exceptions.ProxyError as e:
        print(e)
        sys.exit(1)

if __name__ == "__main__":
    main()
    sys.exit(0)

# Run the script
# python Citrix_RCE_Check.py
# Enter the target server IP address: